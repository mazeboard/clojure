["^ ","~:output",["^ ","~:js","goog.provide('com.fulcrologic.fulcro.algorithms.denormalize');\ncom.fulcrologic.fulcro.algorithms.denormalize._STAR_denormalize_time_STAR_ = (0);\ncom.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_ = null;\n/**\n * Is the given `v` a link ref query (e.g. `[:table '_]) element.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.link_ref_QMARK_ = (function com$fulcrologic$fulcro$algorithms$denormalize$link_ref_QMARK_(v){\nreturn ((cljs.core.vector_QMARK_(v)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((2),cljs.core.count(v))) && ((cljs.core.first(v) instanceof cljs.core.Keyword)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\"_\",\"_\",-1201019570,null),cljs.core.second(v))));\n});\n/**\n * Is the given `v` a lookup ref query (i.e. ident)?\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_ = (function com$fulcrologic$fulcro$algorithms$denormalize$lookup_ref_QMARK_(v){\nreturn ((cljs.core.vector_QMARK_(v)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((2),cljs.core.count(v))) && ((cljs.core.first(v) instanceof cljs.core.Keyword)));\n});\n/**\n * Returns the value defined by the `ref` from `state-map`.  Works for link refs and\n *   lookup refs.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.follow_ref = (function com$fulcrologic$fulcro$algorithms$denormalize$follow_ref(state_map,p__54957){\nvar vec__54959 = p__54957;\nvar table = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54959,(0),null);\nvar id = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54959,(1),null);\nvar ref = vec__54959;\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\"_\",\"_\",-1201019570,null),id)){\nif(cljs.core.truth_(com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_)){\ncljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_,cljs.core.conj_BANG_,table);\n} else {\n}\n\nreturn cljs.core.get.cljs$core$IFn$_invoke$arity$2(state_map,table);\n} else {\nif(cljs.core.truth_(com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_)){\ncljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_,cljs.core.conj_BANG_,ref);\n} else {\n}\n\nreturn cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(state_map,ref);\n}\n});\n/**\n * Returns the key to use in results for the given ref (ident of lookup ref). For link refs this is just\n *   the first element, and for idents it is the ident.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.ref_key = (function com$fulcrologic$fulcro$algorithms$denormalize$ref_key(p__54971){\nvar vec__54973 = p__54971;\nvar table = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54973,(0),null);\nvar id = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54973,(1),null);\nvar ref = vec__54973;\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\"_\",\"_\",-1201019570,null),id)){\nreturn table;\n} else {\nreturn ref;\n}\n});\n/**\n * Associates time metadata with the given props. This time can be used by rendering optimizations to decide when\n *   stale props are passed to it from a parent in cases where props tunnelling was used for localized refresh.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.with_time = (function com$fulcrologic$fulcro$algorithms$denormalize$with_time(props,t){\nreturn cljs.core.vary_meta.cljs$core$IFn$_invoke$arity$4(props,cljs.core.assoc,new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"time\",\"com.fulcrologic.fulcro.algorithms.denormalize/time\",-375164969),t);\n});\n/**\n * Walk the given AST children (which MUST be prop nodes), and add their values from `current-entity`\n *   (if found).\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.add_props_BANG_ = (function com$fulcrologic$fulcro$algorithms$denormalize$add_props_BANG_(transient_node,entity,ast_prop_children,state_map){\nreturn cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (n,p__54985){\nvar map__54986 = p__54985;\nvar map__54986__$1 = (((((!((map__54986 == null))))?(((((map__54986.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__54986.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__54986):map__54986);\nvar key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54986__$1,new cljs.core.Keyword(null,\"key\",\"key\",-1516042587));\nif(com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(key)){\nvar temp__5751__auto__ = com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,key);\nif(cljs.core.truth_(temp__5751__auto__)){\nvar x = temp__5751__auto__;\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,com.fulcrologic.fulcro.algorithms.denormalize.ref_key(key),x);\n} else {\nreturn n;\n}\n} else {\nvar temp__5751__auto__ = (function (){var and__4120__auto__ = cljs.core.coll_QMARK_(entity);\nif(and__4120__auto__){\nreturn cljs.core.find(entity,key);\n} else {\nreturn and__4120__auto__;\n}\n})();\nif(cljs.core.truth_(temp__5751__auto__)){\nvar entry = temp__5751__auto__;\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key,cljs.core.second(entry));\n} else {\nreturn n;\n}\n}\n}),transient_node,ast_prop_children);\n});\n/**\n * Reduce the query depth on `join-node` that appears within the children of `parent-node`.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.reduce_depth = (function com$fulcrologic$fulcro$algorithms$denormalize$reduce_depth(parent_node,join_node){\nvar join_node_index = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (idx,n){\nif((join_node === n)){\nreturn cljs.core.reduced(idx);\n} else {\nreturn (idx + (1));\n}\n}),(0),new cljs.core.Keyword(null,\"children\",\"children\",-940561982).cljs$core$IFn$_invoke$arity$1(parent_node));\nreturn cljs.core.update_in.cljs$core$IFn$_invoke$arity$3(parent_node,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"children\",\"children\",-940561982),join_node_index,new cljs.core.Keyword(null,\"query\",\"query\",-1288509510)], null),cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.dec,(1)));\n});\ncom.fulcrologic.fulcro.algorithms.denormalize.add_join_BANG_ = (function com$fulcrologic$fulcro$algorithms$denormalize$add_join_BANG_(n,p__55004,entity,state_map,parent_node,idents_seen){\nvar map__55005 = p__55004;\nvar map__55005__$1 = (((((!((map__55005 == null))))?(((((map__55005.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__55005.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__55005):map__55005);\nvar join_node = map__55005__$1;\nvar query = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55005__$1,new cljs.core.Keyword(null,\"query\",\"query\",-1288509510));\nvar key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55005__$1,new cljs.core.Keyword(null,\"key\",\"key\",-1516042587));\nvar link_join_QMARK_ = com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(key);\nvar v = ((link_join_QMARK_)?com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,key):cljs.core.get.cljs$core$IFn$_invoke$arity$2(entity,key));\nvar key__$1 = ((com.fulcrologic.fulcro.algorithms.denormalize.link_ref_QMARK_(key))?cljs.core.first(key):key);\nvar is_ref_QMARK_ = com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(v);\nvar join_entity = ((is_ref_QMARK_)?com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,v):v);\nvar to_many_QMARK_ = (((!(is_ref_QMARK_))) && (cljs.core.vector_QMARK_(join_entity)));\nvar depth_based_QMARK_ = cljs.core.int_QMARK_(query);\nvar recursive_QMARK_ = ((depth_based_QMARK_) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\"...\",\"...\",-1926939749,null),query)));\nvar stop_recursion_QMARK_ = ((recursive_QMARK_) && (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((0),query)) || (((is_ref_QMARK_) && ((!(depth_based_QMARK_))) && (cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(idents_seen,key__$1),v)))))));\nvar parent_node__$1 = ((((depth_based_QMARK_) && ((!(stop_recursion_QMARK_)))))?com.fulcrologic.fulcro.algorithms.denormalize.reduce_depth(parent_node,join_node):parent_node);\nvar target_node = ((recursive_QMARK_)?parent_node__$1:join_node);\nvar parent_idents_seen = idents_seen;\nvar idents_seen__$1 = ((is_ref_QMARK_)?cljs.core.update.cljs$core$IFn$_invoke$arity$4(idents_seen,key__$1,cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.conj,cljs.core.PersistentHashSet.EMPTY),v):((((to_many_QMARK_) && (cljs.core.every_QMARK_(com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_,v))))?cljs.core.update.cljs$core$IFn$_invoke$arity$4(idents_seen,key__$1,cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(clojure.set.union,cljs.core.PersistentHashSet.EMPTY),cljs.core.set(v)):idents_seen\n));\nif(stop_recursion_QMARK_){\nif(cljs.core.truth_((function (){var and__4120__auto__ = goog.DEBUG;\nif(cljs.core.truth_(and__4120__auto__)){\nreturn (!(depth_based_QMARK_));\n} else {\nreturn and__4120__auto__;\n}\n})())){\ntaoensso.timbre._log_BANG_.cljs$core$IFn$_invoke$arity$11(taoensso.timbre._STAR_config_STAR_,new cljs.core.Keyword(null,\"warn\",\"warn\",-436710552),\"com.fulcrologic.fulcro.algorithms.denormalize\",null,109,new cljs.core.Keyword(null,\"p\",\"p\",151049309),new cljs.core.Keyword(null,\"auto\",\"auto\",-566279492),(new cljs.core.Delay(((function (link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key){\nreturn (function (){\nreturn new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [\"Loop detected in data graph at \",entity,\". Recursive query stopped. See https://book.fulcrologic.com/#warn-denormalize-loop-detected\"], null);\n});})(link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key))\n,null)),null,1715999919,null);\n} else {\n}\n\nreturn n;\n} else {\nif(to_many_QMARK_){\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key__$1,cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.keep.cljs$core$IFn$_invoke$arity$1(((function (link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key){\nreturn (function (x){\nvar e = ((com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(x))?com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,x):x);\nvar stop_recursion_QMARK___$1 = ((recursive_QMARK_) && (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((0),query)) || (((com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(x)) && ((!(depth_based_QMARK_))) && (cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(parent_idents_seen,key__$1),x)))))));\nif(stop_recursion_QMARK___$1){\nif(cljs.core.truth_(goog.DEBUG)){\ntaoensso.timbre._log_BANG_.cljs$core$IFn$_invoke$arity$11(taoensso.timbre._STAR_config_STAR_,new cljs.core.Keyword(null,\"warn\",\"warn\",-436710552),\"com.fulcrologic.fulcro.algorithms.denormalize\",null,124,new cljs.core.Keyword(null,\"p\",\"p\",151049309),new cljs.core.Keyword(null,\"auto\",\"auto\",-566279492),(new cljs.core.Delay(((function (e,stop_recursion_QMARK___$1,link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key){\nreturn (function (){\nreturn new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [\"Loop detected in data graph at \",e,\". Recursive query stopped.\"], null);\n});})(e,stop_recursion_QMARK___$1,link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key))\n,null)),null,-1236996046,null);\n} else {\n}\n\nreturn null;\n} else {\nreturn (com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(target_node,e,state_map,idents_seen__$1) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,target_node,e,state_map,idents_seen__$1));\n}\n});})(link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key))\n),join_entity));\n} else {\nif(cljs.core.truth_((function (){var and__4120__auto__ = recursive_QMARK_;\nif(and__4120__auto__){\nreturn join_entity;\n} else {\nreturn and__4120__auto__;\n}\n})())){\nif(depth_based_QMARK_){\nvar join_node_index = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(((function (link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key){\nreturn (function (idx,n__$1){\nif((join_node === n__$1)){\nreturn cljs.core.reduced(idx);\n} else {\nreturn (idx + (1));\n}\n});})(link_join_QMARK_,v,key__$1,is_ref_QMARK_,join_entity,to_many_QMARK_,depth_based_QMARK_,recursive_QMARK_,stop_recursion_QMARK_,parent_node__$1,target_node,parent_idents_seen,idents_seen__$1,map__55005,map__55005__$1,join_node,query,key))\n,(0),new cljs.core.Keyword(null,\"children\",\"children\",-940561982).cljs$core$IFn$_invoke$arity$1(parent_node__$1));\nvar parent_node__$2 = cljs.core.update_in.cljs$core$IFn$_invoke$arity$3(parent_node__$1,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"children\",\"children\",-940561982),join_node_index,new cljs.core.Keyword(null,\"query\",\"query\",-1288509510)], null),cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.dec,(1)));\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key__$1,(com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(parent_node__$2,join_entity,state_map,idents_seen__$1) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,parent_node__$2,join_entity,state_map,idents_seen__$1)));\n} else {\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key__$1,(com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(parent_node__$1,join_entity,state_map,idents_seen__$1) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,parent_node__$1,join_entity,state_map,idents_seen__$1)));\n}\n} else {\nif(cljs.core.map_QMARK_(join_entity)){\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key__$1,(com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(target_node,join_entity,state_map,idents_seen__$1) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,target_node,join_entity,state_map,idents_seen__$1)));\n} else {\nif(((cljs.core.contains_QMARK_(entity,key__$1)) && ((!(recursive_QMARK_))) && ((!(link_join_QMARK_))))){\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key__$1,v);\n} else {\nreturn n;\n\n}\n}\n}\n}\n}\n});\ncom.fulcrologic.fulcro.algorithms.denormalize.add_union_BANG_ = (function com$fulcrologic$fulcro$algorithms$denormalize$add_union_BANG_(n,p__55023,entity,state_map,idents_seen){\nvar map__55024 = p__55023;\nvar map__55024__$1 = (((((!((map__55024 == null))))?(((((map__55024.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__55024.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__55024):map__55024);\nvar join_node = map__55024__$1;\nvar key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55024__$1,new cljs.core.Keyword(null,\"key\",\"key\",-1516042587));\nvar link_join_QMARK_ = com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(key);\nvar v = ((link_join_QMARK_)?key:cljs.core.get.cljs$core$IFn$_invoke$arity$2(entity,key));\nvar union_node = cljs.core.first(new cljs.core.Keyword(null,\"children\",\"children\",-940561982).cljs$core$IFn$_invoke$arity$1(join_node));\nvar union_key__GT_query = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(((function (link_join_QMARK_,v,union_node,map__55024,map__55024__$1,join_node,key){\nreturn (function (result,p__55029){\nvar map__55030 = p__55029;\nvar map__55030__$1 = (((((!((map__55030 == null))))?(((((map__55030.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__55030.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__55030):map__55030);\nvar node = map__55030__$1;\nvar union_key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55030__$1,new cljs.core.Keyword(null,\"union-key\",\"union-key\",1529707234));\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(result,union_key,node);\n});})(link_join_QMARK_,v,union_node,map__55024,map__55024__$1,join_node,key))\n,cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,\"children\",\"children\",-940561982).cljs$core$IFn$_invoke$arity$1(union_node));\nvar is_ref_QMARK_ = com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(v);\nvar to_many_QMARK_ = (((!(is_ref_QMARK_))) && (cljs.core.vector_QMARK_(v)));\nif(to_many_QMARK_){\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key,cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.keep.cljs$core$IFn$_invoke$arity$1(((function (link_join_QMARK_,v,union_node,union_key__GT_query,is_ref_QMARK_,to_many_QMARK_,map__55024,map__55024__$1,join_node,key){\nreturn (function (lookup_ref){\nvar temp__5751__auto__ = (function (){var and__4120__auto__ = com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(lookup_ref);\nif(and__4120__auto__){\nreturn com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,lookup_ref);\n} else {\nreturn and__4120__auto__;\n}\n})();\nif(cljs.core.truth_(temp__5751__auto__)){\nvar e = temp__5751__auto__;\nvar vec__55034 = lookup_ref;\nvar table = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55034,(0),null);\nvar temp__5751__auto____$1 = (union_key__GT_query.cljs$core$IFn$_invoke$arity$1 ? union_key__GT_query.cljs$core$IFn$_invoke$arity$1(table) : union_key__GT_query.call(null,table));\nif(cljs.core.truth_(temp__5751__auto____$1)){\nvar target_ast_node = temp__5751__auto____$1;\nreturn (com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(target_ast_node,e,state_map,idents_seen) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,target_ast_node,e,state_map,idents_seen));\n} else {\nreturn cljs.core.PersistentArrayMap.EMPTY;\n}\n} else {\nreturn cljs.core.PersistentArrayMap.EMPTY;\n}\n});})(link_join_QMARK_,v,union_node,union_key__GT_query,is_ref_QMARK_,to_many_QMARK_,map__55024,map__55024__$1,join_node,key))\n),v));\n} else {\nif(is_ref_QMARK_){\nvar temp__5751__auto__ = com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,v);\nif(cljs.core.truth_(temp__5751__auto__)){\nvar e = temp__5751__auto__;\nvar temp__5751__auto____$1 = (function (){var G__55039 = cljs.core.first(v);\nreturn (union_key__GT_query.cljs$core$IFn$_invoke$arity$1 ? union_key__GT_query.cljs$core$IFn$_invoke$arity$1(G__55039) : union_key__GT_query.call(null,G__55039));\n})();\nif(cljs.core.truth_(temp__5751__auto____$1)){\nvar target_ast_node = temp__5751__auto____$1;\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key,(com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4 ? com.fulcrologic.fulcro.algorithms.denormalize.denormalize.cljs$core$IFn$_invoke$arity$4(target_ast_node,e,state_map,idents_seen) : com.fulcrologic.fulcro.algorithms.denormalize.denormalize.call(null,target_ast_node,e,state_map,idents_seen)));\n} else {\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key,cljs.core.PersistentArrayMap.EMPTY);\n}\n} else {\nreturn n;\n}\n} else {\nif(((cljs.core.contains_QMARK_(entity,key)) && ((!(link_join_QMARK_))))){\nreturn cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(n,key,v);\n} else {\nreturn n;\n\n}\n}\n}\n});\ncom.fulcrologic.fulcro.algorithms.denormalize.add_joins_BANG_ = (function com$fulcrologic$fulcro$algorithms$denormalize$add_joins_BANG_(transient_node,entity,state_map,parent_node,ast_join_nodes,idents_seen){\nreturn cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (n,join_node){\nvar union_QMARK_ = cljs.core.map_QMARK_(new cljs.core.Keyword(null,\"query\",\"query\",-1288509510).cljs$core$IFn$_invoke$arity$1(join_node));\nif(union_QMARK_){\nreturn com.fulcrologic.fulcro.algorithms.denormalize.add_union_BANG_(n,join_node,entity,state_map,idents_seen);\n} else {\nreturn com.fulcrologic.fulcro.algorithms.denormalize.add_join_BANG_(n,join_node,entity,state_map,parent_node,idents_seen);\n}\n}),transient_node,ast_join_nodes);\n});\n/**\n * Internal implementation of `db->tree`.  You should normally use `db->tree` instead of this function.\n * \n *   - `top-node`: an AST for the query.\n *   - `current-entity`: The entity to start denormalization from.\n *   - `state-map`: a normalized database.\n *   - `idents-seen`: a map of the idents seen so far (for recursion loop tracking).\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.denormalize = (function com$fulcrologic$fulcro$algorithms$denormalize$denormalize(p__55044,current_entity,state_map,idents_seen){\nvar map__55045 = p__55044;\nvar map__55045__$1 = (((((!((map__55045 == null))))?(((((map__55045.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__55045.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__55045):map__55045);\nvar top_node = map__55045__$1;\nvar type = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55045__$1,new cljs.core.Keyword(null,\"type\",\"type\",1174270348));\nvar children = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55045__$1,new cljs.core.Keyword(null,\"children\",\"children\",-940561982));\nif(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(type,new cljs.core.Keyword(null,\"prop\",\"prop\",-515168332))){\n} else {\nthrow (new Error(\"Assert failed: (not= type :prop)\"));\n}\n\nvar current_entity__$1 = ((com.fulcrologic.fulcro.algorithms.denormalize.lookup_ref_QMARK_(current_entity))?com.fulcrologic.fulcro.algorithms.denormalize.follow_ref(state_map,current_entity):current_entity);\nvar grouped_children = cljs.core.group_by(new cljs.core.Keyword(null,\"type\",\"type\",1174270348),children);\nvar nil_nodes = cljs.core.get.cljs$core$IFn$_invoke$arity$3(grouped_children,null,false);\nvar wildcard_QMARK_ = (function (){var and__4120__auto__ = nil_nodes;\nif(cljs.core.truth_(and__4120__auto__)){\nreturn cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\"*\",\"*\",345799209,null),(function (){var G__55049 = nil_nodes;\nvar G__55049__$1 = (((G__55049 == null))?null:cljs.core.first(G__55049));\nif((G__55049__$1 == null)){\nreturn null;\n} else {\nreturn new cljs.core.Keyword(null,\"key\",\"key\",-1516042587).cljs$core$IFn$_invoke$arity$1(G__55049__$1);\n}\n})());\n} else {\nreturn and__4120__auto__;\n}\n})();\nvar result_node = com.fulcrologic.fulcro.algorithms.denormalize.add_props_BANG_(cljs.core.transient$((cljs.core.truth_(wildcard_QMARK_)?current_entity__$1:cljs.core.PersistentArrayMap.EMPTY)),current_entity__$1,new cljs.core.Keyword(null,\"prop\",\"prop\",-515168332).cljs$core$IFn$_invoke$arity$1(grouped_children),state_map);\nvar result_node__$1 = com.fulcrologic.fulcro.algorithms.denormalize.add_joins_BANG_(result_node,current_entity__$1,state_map,top_node,new cljs.core.Keyword(null,\"join\",\"join\",-758861890).cljs$core$IFn$_invoke$arity$1(grouped_children),idents_seen);\nvar G__55053 = result_node__$1;\nvar G__55053__$1 = (((G__55053 == null))?null:cljs.core.persistent_BANG_(G__55053));\nif((G__55053__$1 == null)){\nreturn null;\n} else {\nreturn com.fulcrologic.fulcro.algorithms.denormalize.with_time(G__55053__$1,com.fulcrologic.fulcro.algorithms.denormalize._STAR_denormalize_time_STAR_);\n}\n});\n/**\n * Pull a tree of data from a fulcro normalized database as a tree corresponding to the given query.\n * \n *   query - EQL.\n *   starting-entity - A map of data or ident at which to start.\n *   state-map - The overall normalized database from which idents can be resolved.\n * \n *   Returns a tree of data where each resolved data node is also marked with the current\n *   *denormalize-time* (dynamically bound outside of this call). Users of this function that\n *   are hydrating the UI should ensure that this time is bound to Fulcro's current internal\n *   basis-time using `binding`.\n * \n *   The `state-map` needs to be your entire Fulcro database. This database is used to resolve the joins in the EQL query\n *   (which are represented as `idents`).\n * \n *   The starting entity can be `state-map` as well if your EQL query starts from your root. If not, it can simply be\n *   the map (taken from the `state-map`) of the entity whose query you're using.\n * \n *   For example:\n * \n *   ```\n *   (defsc SomeComponent [this props]\n *  {:ident :thing/id\n *   :query [...]})\n * \n *   ;; Get the sub-tree of data for thing 1:\n *   (db->tree\n *  (comp/get-query SomeComponent)\n *  (get-in state-map [:thing/id 1])\n *  state-map)\n *   ```\n *   \n */\ncom.fulcrologic.fulcro.algorithms.denormalize.db__GT_tree = (function com$fulcrologic$fulcro$algorithms$denormalize$db__GT_tree(query,starting_entity,state_map){\nvar ast = edn_query_language.core.query__GT_ast(query);\nvar G__55057 = com.fulcrologic.fulcro.algorithms.denormalize.denormalize(ast,starting_entity,state_map,cljs.core.PersistentArrayMap.EMPTY);\nif((G__55057 == null)){\nreturn null;\n} else {\nreturn com.fulcrologic.fulcro.algorithms.denormalize.with_time(G__55057,com.fulcrologic.fulcro.algorithms.denormalize._STAR_denormalize_time_STAR_);\n}\n});\n/**\n * Gets the time at which the given props were processed by `db->tree`, if known.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.denormalization_time = (function com$fulcrologic$fulcro$algorithms$denormalize$denormalization_time(props){\nvar G__55059 = props;\nvar G__55059__$1 = (((G__55059 == null))?null:cljs.core.meta(G__55059));\nif((G__55059__$1 == null)){\nreturn null;\n} else {\nreturn new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"time\",\"com.fulcrologic.fulcro.algorithms.denormalize/time\",-375164969).cljs$core$IFn$_invoke$arity$1(G__55059__$1);\n}\n});\n/**\n * Similar to `db->tree`; however, the returned props will have annotated metadata the indicates what root keys and\n * idents were visited during the conversion to a tree, along with the source state map that was used. Such props can\n * be used with `possibly-stale?` to do very fast checks to see if an update is needed when `state-map` changes.\n */\ncom.fulcrologic.fulcro.algorithms.denormalize.traced_db__GT_tree = (function com$fulcrologic$fulcro$algorithms$denormalize$traced_db__GT_tree(state_map,root_key_or_ident,query){\nvar _STAR_root_keys_and_idents_STAR__orig_val__55062 = com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_;\nvar _STAR_root_keys_and_idents_STAR__temp_val__55063 = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.transient$(cljs.core.PersistentHashSet.createAsIfByAssoc([root_key_or_ident])));\ncom.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_ = _STAR_root_keys_and_idents_STAR__temp_val__55063;\n\ntry{var starting_point = (((root_key_or_ident instanceof cljs.core.Keyword))?state_map:cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(state_map,root_key_or_ident));\nvar query__$1 = (((root_key_or_ident instanceof cljs.core.Keyword))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentArrayMap.createAsIfByAssoc([root_key_or_ident,query])], null):query);\nvar result = com.fulcrologic.fulcro.algorithms.denormalize.db__GT_tree(query__$1,starting_point,state_map);\nreturn cljs.core.vary_meta.cljs$core$IFn$_invoke$arity$6(result,cljs.core.assoc,new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"visited\",\"com.fulcrologic.fulcro.algorithms.denormalize/visited\",823384252),cljs.core.persistent_BANG_(cljs.core.deref(com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_)),new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"source-state-map\",\"com.fulcrologic.fulcro.algorithms.denormalize/source-state-map\",-1097808870),state_map);\n}finally {com.fulcrologic.fulcro.algorithms.denormalize._STAR_root_keys_and_idents_STAR_ = _STAR_root_keys_and_idents_STAR__orig_val__55062;\n}});\n/**\n * Returns true if the given `prior-props` are likely to be stale with respect to the `current-state-map`. This function\n * returns true unless the `prior-props` were generated with `traced-db->tree` and have not since lost their metadata.\n * \n * When called with properly-annotated props this function can do a very fast and accurate check to indicate if the props\n * seem out of date. Runs N `identical?` checks (which are reference compares) where N is the number of root keys and idents\n * that were traversed to originally build prior-props.\n * \n * This is not proof that the props have changed, but the false indicators will all be `true`, meaning it is a safe (and\n * faster) replacement for the comparisons that `shouldComponentUpdate` usually use.\n * \n */\ncom.fulcrologic.fulcro.algorithms.denormalize.possibly_stale_QMARK_ = (function com$fulcrologic$fulcro$algorithms$denormalize$possibly_stale_QMARK_(current_state_map,prior_props){\nvar map__55067 = cljs.core.meta(prior_props);\nvar map__55067__$1 = (((((!((map__55067 == null))))?(((((map__55067.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__55067.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__55067):map__55067);\nvar visited = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55067__$1,new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"visited\",\"com.fulcrologic.fulcro.algorithms.denormalize/visited\",823384252));\nvar source_state_map = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__55067__$1,new cljs.core.Keyword(\"com.fulcrologic.fulcro.algorithms.denormalize\",\"source-state-map\",\"com.fulcrologic.fulcro.algorithms.denormalize/source-state-map\",-1097808870));\nif((source_state_map == null)){\nreturn true;\n} else {\nreturn cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(((function (map__55067,map__55067__$1,visited,source_state_map){\nreturn (function (_,path){\nvar old_value = (((path instanceof cljs.core.Keyword))?cljs.core.get.cljs$core$IFn$_invoke$arity$2(source_state_map,path):cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(source_state_map,path));\nvar new_value = (((path instanceof cljs.core.Keyword))?cljs.core.get.cljs$core$IFn$_invoke$arity$2(current_state_map,path):cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(current_state_map,path));\nif((old_value === new_value)){\nreturn false;\n} else {\nreturn cljs.core.reduced(true);\n}\n});})(map__55067,map__55067__$1,visited,source_state_map))\n,false,visited);\n}\n});\n","~:ns-info",["^ ","~:rename-macros",null,"~:renames",["^ "],"~:meta",["^ ","~:doc","The algorithm and support functions for converting a normalized Fulcro database to a tree of denormalized props.","~:file","com/fulcrologic/fulcro/algorithms/denormalize.cljc","~:line",1,"~:column",5,"~:end-line",1,"~:end-column",50],"~:ns-aliases",["^ ","~$cljs.loader","~$shadow.loader","~$clojure.spec.alpha","~$cljs.spec.alpha","~$clojure.core.async","~$cljs.core.async","~$clojure.pprint","~$cljs.pprint","~$clojure.spec.gen.alpha","~$cljs.spec.gen.alpha"],"~:use-macros",null,"~:excludes",["~#set",[]],"~:name","~$com.fulcrologic.fulcro.algorithms.denormalize","~:op","~:ns","~:imports",null,"~:requires",["^ ","~$clojure.set","^P","~$set","^P","~$edn-query-language.core","^R","~$eql","^R","~$taoensso.timbre","^T","~$log","^T","~$cljs.core","^V","~$goog","^W"],"~:seen",["^I",["~:require"]],"~:uses",null,"~:require-macros",["^ ","^V","^V","^T","^T","^U","^T"],"~:form",["~#list",["~$ns","^K","The algorithm and support functions for converting a normalized Fulcro database to a tree of denormalized props.",["^11",["^Y",["^P","~:as","^Q"],["^R","^13","^S"],["^T","^13","^U"]]]]],"~:flags",["^ ","^Y",["^I",[]]],"~:js-deps",["^ "],"~:deps",["^W","^V","^P","^R","^T"]],"^M","^K","~:resource-id",["~:shadow.build.classpath/resource","com/fulcrologic/fulcro/algorithms/denormalize.cljc"],"~:compiled-at",1630698453544,"~:resource-name","com/fulcrologic/fulcro/algorithms/denormalize.cljc","~:warnings",[],"~:source","(ns com.fulcrologic.fulcro.algorithms.denormalize\n  \"The algorithm and support functions for converting a normalized Fulcro database to a tree of denormalized props.\"\n  (:require\n    [clojure.set :as set]\n    [edn-query-language.core :as eql]\n    [taoensso.timbre :as log]))\n\n(def ^:dynamic *denormalize-time* 0)\n(def ^:dynamic *root-keys-and-idents* nil)\n\n(defn link-ref?\n  \"Is the given `v` a link ref query (e.g. `[:table '_]) element.\"\n  [v]\n  (and\n    (vector? v)\n    (= 2 (count v))\n    (keyword? (first v))\n    (= '_ (second v))))\n\n(defn lookup-ref?\n  \"Is the given `v` a lookup ref query (i.e. ident)?\"\n  [v]\n  (and (vector? v) (= 2 (count v)) (keyword? (first v))))\n\n(defn follow-ref\n  \"Returns the value defined by the `ref` from `state-map`.  Works for link refs and\n  lookup refs.\"\n  [state-map [table id :as ref]]\n  (if (= '_ id)\n    (do\n      (when *root-keys-and-idents*\n        (swap! *root-keys-and-idents* conj! table))\n      (get state-map table))\n    (do\n      (when *root-keys-and-idents*\n        (swap! *root-keys-and-idents* conj! ref))\n      (get-in state-map ref))))\n\n(defn ref-key\n  \"Returns the key to use in results for the given ref (ident of lookup ref). For link refs this is just\n  the first element, and for idents it is the ident.\"\n  [[table id :as ref]]\n  (if (= '_ id)\n    table\n    ref))\n\n(declare denormalize)\n\n(defn with-time\n  \"Associates time metadata with the given props. This time can be used by rendering optimizations to decide when\n  stale props are passed to it from a parent in cases where props tunnelling was used for localized refresh.\"\n  [props t]\n  (vary-meta props assoc ::time t))\n\n(defn- add-props!\n  \"Walk the given AST children (which MUST be prop nodes), and add their values from `current-entity`\n  (if found).\"\n  [transient-node entity ast-prop-children state-map]\n  (reduce\n    (fn [n {:keys [key]}]\n      (if (lookup-ref? key)\n        (if-let [x (follow-ref state-map key)]\n          (assoc! n (ref-key key) x)\n          n)\n        (if-let [entry (and (coll? entity) (find entity key))]\n          (assoc! n key (second entry))\n          n)))\n    transient-node\n    ast-prop-children))\n\n(defn- reduce-depth\n  \"Reduce the query depth on `join-node` that appears within the children of `parent-node`.\"\n  [parent-node join-node]\n  (let [join-node-index (reduce\n                          (fn [idx n] (if (identical? join-node n)\n                                        (reduced idx)\n                                        (inc idx)))\n                          0\n                          (:children parent-node))]\n    (update-in parent-node [:children join-node-index :query] (fnil dec 1))))\n\n(defn- add-join! [n {:keys [query key] :as join-node} entity state-map parent-node idents-seen]\n  (let [link-join?         (lookup-ref? key)\n        v                  (if link-join? (follow-ref state-map key) (get entity key))\n        key                (if (link-ref? key) (first key) key)\n        is-ref?            (lookup-ref? v)\n        join-entity        (if is-ref? (follow-ref state-map v) v)\n        to-many?           (and (not is-ref?) (vector? join-entity))\n        depth-based?       (int? query)\n        recursive?         (or depth-based? (= '... query))\n        stop-recursion?    (and recursive? (or (= 0 query)\n                                             (and is-ref?\n                                               ;; NOTE: allows depth-based to ignore loops\n                                               (not depth-based?)\n                                               (contains? (get idents-seen key) v))))\n        parent-node        (if (and depth-based? (not stop-recursion?))\n                             (reduce-depth parent-node join-node)\n                             parent-node)\n        target-node        (if recursive? parent-node join-node)\n        ;; NOTE: fixed bug with old db->tree, so behavior is different\n        parent-idents-seen idents-seen\n        idents-seen        (cond\n                             is-ref? (update idents-seen key (fnil conj #{}) v)\n                             (and to-many? (every? lookup-ref? v)) (update idents-seen key (fnil set/union #{}) (set v))\n                             :else idents-seen)]\n    (cond\n      stop-recursion? (do\n                        (when (and #?(:clj true :cljs goog.DEBUG) (not depth-based?))\n                          (log/warn \"Loop detected in data graph at \" entity \". Recursive query stopped. See https://book.fulcrologic.com/#warn-denormalize-loop-detected\"))\n                        n)\n      to-many? (assoc! n key\n                 (into []\n                   (keep (fn [x]\n                           (let [e               (if (lookup-ref? x)\n                                                   (follow-ref state-map x)\n                                                   x)\n                                 stop-recursion? (and recursive? (or (= 0 query)\n                                                                   (and (lookup-ref? x)\n                                                                     (not depth-based?)\n                                                                     (contains? (get parent-idents-seen key) x))))]\n                             (if stop-recursion?\n                               (do\n                                 (when #?(:clj true :cljs goog.DEBUG)\n                                   (log/warn \"Loop detected in data graph at \" e \". Recursive query stopped.\"))\n                                 nil)\n                               (denormalize target-node e state-map idents-seen)))))\n                   join-entity))\n      (and recursive? join-entity) (if depth-based?\n                                     (let [join-node-index (reduce\n                                                             (fn [idx n] (if (identical? join-node n)\n                                                                           (reduced idx)\n                                                                           (inc idx)))\n                                                             0\n                                                             (:children parent-node))\n                                           parent-node     (update-in parent-node [:children join-node-index :query] (fnil dec 1))]\n                                       (assoc! n key (denormalize parent-node join-entity state-map idents-seen)))\n                                     (assoc! n key (denormalize parent-node join-entity state-map idents-seen)))\n      (map? join-entity) (assoc! n key (denormalize target-node join-entity state-map idents-seen))\n      (and (contains? entity key)\n        (not recursive?)\n        (not link-join?)) (assoc! n key v)\n      :otherwise n)))\n\n(defn- add-union! [n {:keys [key] :as join-node} entity state-map idents-seen]\n  (let [link-join?       (lookup-ref? key)\n        v                (if link-join? key (get entity key))\n        union-node       (-> join-node :children first)\n        union-key->query (reduce\n                           (fn [result {:keys [union-key] :as node}]\n                             (assoc result union-key node))\n                           {}\n                           (:children union-node))\n        is-ref?          (lookup-ref? v)\n        to-many?         (and (not is-ref?) (vector? v))]\n    (cond\n      to-many? (assoc! n key\n                 (into []\n                   (keep (fn [lookup-ref]\n                           (if-let [e (and (lookup-ref? lookup-ref)\n                                        (follow-ref state-map lookup-ref))]\n                             (let [[table] lookup-ref]\n                               (if-let [target-ast-node (union-key->query table)]\n                                 (denormalize target-ast-node e state-map idents-seen)\n                                 {}))\n                             {})))\n                   v))\n      is-ref? (if-let [e (follow-ref state-map v)]\n                (if-let [target-ast-node (union-key->query (first v))]\n                  (assoc! n key (denormalize target-ast-node e state-map idents-seen))\n                  (assoc! n key {}))\n                n)\n      (and (contains? entity key)\n        (not link-join?)) (assoc! n key v)\n      :otherwise n)))\n\n(defn- add-joins! [transient-node entity state-map parent-node ast-join-nodes idents-seen]\n  (reduce\n    (fn [n join-node]\n      (let [union? (map? (:query join-node))]\n        (if union?\n          (add-union! n join-node entity state-map idents-seen)\n          (add-join! n join-node entity state-map parent-node idents-seen))))\n    transient-node\n    ast-join-nodes))\n\n(defn denormalize\n  \"Internal implementation of `db->tree`.  You should normally use `db->tree` instead of this function.\n\n  - `top-node`: an AST for the query.\n  - `current-entity`: The entity to start denormalization from.\n  - `state-map`: a normalized database.\n  - `idents-seen`: a map of the idents seen so far (for recursion loop tracking).\"\n  [{:keys [type children] :as top-node} current-entity state-map idents-seen]\n  (assert (not= type :prop))\n  (let [current-entity   (if (lookup-ref? current-entity)\n                           (follow-ref state-map current-entity)\n                           current-entity)\n        grouped-children (group-by :type children)\n        nil-nodes        (get grouped-children nil false)\n        ;; NOTE: wildcard works better than the old db->tree (which ignores wildcard when joins are present)\n        wildcard?        (and nil-nodes (= '* (some-> nil-nodes first :key)))\n        result-node      (add-props! (transient (if wildcard? current-entity {})) current-entity (:prop grouped-children) state-map)\n        result-node      (add-joins! result-node current-entity state-map\n                           top-node\n                           (:join grouped-children)\n                           idents-seen)]\n    (some-> result-node (persistent!) (with-time *denormalize-time*))))\n\n(defn db->tree\n  \"Pull a tree of data from a fulcro normalized database as a tree corresponding to the given query.\n\n  query - EQL.\n  starting-entity - A map of data or ident at which to start.\n  state-map - The overall normalized database from which idents can be resolved.\n\n  Returns a tree of data where each resolved data node is also marked with the current\n  *denormalize-time* (dynamically bound outside of this call). Users of this function that\n  are hydrating the UI should ensure that this time is bound to Fulcro's current internal\n  basis-time using `binding`.\n\n  The `state-map` needs to be your entire Fulcro database. This database is used to resolve the joins in the EQL query\n  (which are represented as `idents`).\n\n  The starting entity can be `state-map` as well if your EQL query starts from your root. If not, it can simply be\n  the map (taken from the `state-map`) of the entity whose query you're using.\n\n  For example:\n\n  ```\n  (defsc SomeComponent [this props]\n    {:ident :thing/id\n     :query [...]})\n\n  ;; Get the sub-tree of data for thing 1:\n  (db->tree\n    (comp/get-query SomeComponent)\n    (get-in state-map [:thing/id 1])\n    state-map)\n  ```\n  \"\n  [query starting-entity state-map]\n  (let [ast (eql/query->ast query)]\n    (some-> (denormalize ast starting-entity state-map {})\n      (with-time *denormalize-time*))))\n\n(defn denormalization-time\n  \"Gets the time at which the given props were processed by `db->tree`, if known.\"\n  [props]\n  (some-> props meta ::time))\n\n(defn traced-db->tree\n  \"Similar to `db->tree`; however, the returned props will have annotated metadata the indicates what root keys and\n   idents were visited during the conversion to a tree, along with the source state map that was used. Such props can\n   be used with `possibly-stale?` to do very fast checks to see if an update is needed when `state-map` changes.\"\n  [state-map root-key-or-ident query]\n  (binding [*root-keys-and-idents* (atom (transient #{root-key-or-ident}))]\n    (let [starting-point (if (keyword? root-key-or-ident) state-map (get-in state-map root-key-or-ident))\n          query          (if (keyword? root-key-or-ident) [{root-key-or-ident query}] query)\n          result         (db->tree query starting-point state-map)]\n      (vary-meta result assoc\n        ::visited (persistent! @*root-keys-and-idents*)\n        ::source-state-map state-map))))\n\n(defn possibly-stale?\n  \"Returns true if the given `prior-props` are likely to be stale with respect to the `current-state-map`. This function\n   returns true unless the `prior-props` were generated with `traced-db->tree` and have not since lost their metadata.\n\n   When called with properly-annotated props this function can do a very fast and accurate check to indicate if the props\n   seem out of date. Runs N `identical?` checks (which are reference compares) where N is the number of root keys and idents\n   that were traversed to originally build prior-props.\n\n   This is not proof that the props have changed, but the false indicators will all be `true`, meaning it is a safe (and\n   faster) replacement for the comparisons that `shouldComponentUpdate` usually use.\n   \"\n  [current-state-map prior-props]\n  (let [{::keys [visited source-state-map]} (meta prior-props)]\n    (if (nil? source-state-map)\n      true\n      (reduce\n        (fn [_ path]\n          (let [old-value (if (keyword? path)\n                            (get source-state-map path)\n                            (get-in source-state-map path))\n                new-value (if (keyword? path)\n                            (get current-state-map path)\n                            (get-in current-state-map path))]\n            (if (identical? old-value new-value)\n              false\n              (reduced true))))\n        false\n        visited))))","~:reader-features",["^I",["~:cljs"]],"~:cljc",true,"~:source-map-compact",["^ ","mappings","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","names",["com.fulcrologic.fulcro.algorithms.denormalize/*denormalize-time*","com.fulcrologic.fulcro.algorithms.denormalize/*root-keys-and-idents*","com.fulcrologic.fulcro.algorithms.denormalize/link-ref?","v","cljs.core/vector?","cljs.core._EQ_","cljs.core/count","cljs.core/Keyword","cljs.core/first","cljs.core/second","com.fulcrologic.fulcro.algorithms.denormalize/lookup-ref?","p__54957","vec__54959","cljs.core.nth","com.fulcrologic.fulcro.algorithms.denormalize/follow-ref","state-map","table","id","ref","cljs.core.swap_BANG_","cljs.core/conj!","cljs.core.get","cljs.core.get_in","p__54971","vec__54973","com.fulcrologic.fulcro.algorithms.denormalize/ref-key","com.fulcrologic.fulcro.algorithms.denormalize/with-time","props","t","cljs.core.vary_meta","cljs.core/assoc","com.fulcrologic.fulcro.algorithms.denormalize/add-props!","transient-node","entity","ast-prop-children","cljs.core.reduce","p__54985","map__54986","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","n","key","temp__5751__auto__","x","cljs.core.assoc_BANG_","entry","and__4120__auto__","cljs.core/coll?","cljs.core/find","com.fulcrologic.fulcro.algorithms.denormalize/reduce-depth","parent-node","join-node","join-node-index","idx","cljs.core/reduced","cljs.core.update_in","cljs.core.fnil","cljs.core/dec","p__55004","map__55005","com.fulcrologic.fulcro.algorithms.denormalize/add-join!","query","idents-seen","link-join?","is-ref?","join-entity","to-many?","depth-based?","cljs.core/int?","recursive?","stop-recursion?","cljs.core/contains?","target-node","parent-idents-seen","cljs.core.update","cljs.core/conj","cljs.core/every?","clojure.set/union","cljs.core/set","js/goog.DEBUG","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","cljs.core.into","cljs.core.keep","e","com.fulcrologic.fulcro.algorithms.denormalize/denormalize","cljs.core/map?","p__55023","map__55024","com.fulcrologic.fulcro.algorithms.denormalize/add-union!","union-node","union-key->query","p__55029","map__55030","result","union-key","node","cljs.core.assoc","lookup-ref","vec__55034","target-ast-node","G__55039","com.fulcrologic.fulcro.algorithms.denormalize/add-joins!","ast-join-nodes","union?","p__55044","map__55045","type","children","top-node","current-entity","js/Error","cljs.core.not_EQ_","grouped-children","cljs.core/group-by","nil-nodes","wildcard?","G__55049","result-node","cljs.core/transient","G__55053","cljs.core/persistent!","com.fulcrologic.fulcro.algorithms.denormalize/db->tree","starting-entity","ast","edn-query-language.core/query->ast","G__55057","com.fulcrologic.fulcro.algorithms.denormalize/denormalization-time","G__55059","cljs.core/meta","com.fulcrologic.fulcro.algorithms.denormalize/traced-db->tree","root-key-or-ident","*root-keys-and-idents*-orig-val__55062","*root-keys-and-idents*-temp-val__55063","cljs.core.atom","starting-point","cljs.core/deref","com.fulcrologic.fulcro.algorithms.denormalize/possibly-stale?","current-state-map","prior-props","map__55067","visited","source-state-map","_","path","old-value","new-value"]],"~:used-vars",["^I",["~$cljs.core/keep","~$com.fulcrologic.fulcro.algorithms.denormalize/with-time","~$com.fulcrologic.fulcro.algorithms.denormalize/follow-ref","~$cljs.core/vector?","~$cljs.core/=","~$cljs.core/dec","~$taoensso.timbre/-log!","~$cljs.core/count","~$cljs.core/deref","~$com.fulcrologic.fulcro.algorithms.denormalize/lookup-ref?","~$cljs.core/reduce","~$cljs.core/Keyword","~$com.fulcrologic.fulcro.algorithms.denormalize/reduce-depth","~$com.fulcrologic.fulcro.algorithms.denormalize/denormalize","~$cljs.core/not=","~$cljs.core/Delay","~$com.fulcrologic.fulcro.algorithms.denormalize/add-join!","~$cljs.core/fnil","~$cljs.core/contains?","~$cljs.core/into","~$cljs.core/map?","~$taoensso.timbre/*config*","~$cljs.core/vary-meta","~$com.fulcrologic.fulcro.algorithms.denormalize/add-props!","~$com.fulcrologic.fulcro.algorithms.denormalize/ref-key","~$cljs.core/get-in","~$cljs.core/swap!","~$com.fulcrologic.fulcro.algorithms.denormalize/add-union!","~$cljs.core/get","~$cljs.core/conj!","~$cljs.core/persistent!","~$cljs.core/reduced","~$com.fulcrologic.fulcro.algorithms.denormalize/db->tree","~$cljs.core/second","~$js/goog.DEBUG","~$cljs.core/not","~$com.fulcrologic.fulcro.algorithms.denormalize/link-ref?","~$com.fulcrologic.fulcro.algorithms.denormalize/*root-keys-and-idents*","~$cljs.core/assoc","~$com.fulcrologic.fulcro.algorithms.denormalize/add-joins!","~$com.fulcrologic.fulcro.algorithms.denormalize/*denormalize-time*","~$com.fulcrologic.fulcro.algorithms.denormalize/traced-db->tree","~$com.fulcrologic.fulcro.algorithms.denormalize/denormalization-time","~$cljs.core/first","~$cljs.core/assoc!","~$com.fulcrologic.fulcro.algorithms.denormalize/possibly-stale?","~$cljs.core/update-in","~$js/Error"]]],"~:cache-keys",["~#cmap",[["^18","goog/dom/tagname.js"],["6025affb7181cd40418600864f58eed1ea80055d","~:shadow.build.compiler/resolve",["^ ","~:require-id",null,"~:deps-ids",["^I",[]],"~:deps-syms",["^W","~$goog.dom.HtmlElement"]]],["^18","goog/async/freelist.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/i18n/datetimesymbols.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/labs/useragent/platform.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.labs.userAgent.util","~$goog.string"]]],["^18","goog/timer/timer.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.Promise","~$goog.events.EventTarget"]]],["^18","cljs/spec/gen/alpha.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","~$goog.Uri"]]],["^18","cljs/tools/reader/impl/utils.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","~$clojure.string","^2P"]]],["^18","goog/math/math.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.array","~$goog.asserts"]]],["^18","goog/html/trustedtypes.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/string/stringformat.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2P"]]],["^18","goog/events/eventtype.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.events.BrowserFeature","~$goog.userAgent"]]],["^18","goog/labs/useragent/browser.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2O","~$goog.object","~$goog.string.internal"]]],["^18","goog/html/safeurl.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.fs.url","~$goog.html.TrustedResourceUrl","~$goog.i18n.bidi.Dir","~$goog.i18n.bidi.DirectionalString","~$goog.string.Const","~$goog.string.TypedString","^2Z"]]],["^18","goog/array/array.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V"]]],["^18","goog/useragent/useragent.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.labs.userAgent.browser","~$goog.labs.userAgent.engine","~$goog.labs.userAgent.platform","^2O","~$goog.reflect","^2P"]]],["^18","goog/structs/prioritypool.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.structs.Pool","~$goog.structs.PriorityQueue"]]],["^18","goog/async/run.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.async.WorkQueue","~$goog.async.nextTick","~$goog.async.throwException"]]],["^18","goog/debug/error.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/async/workqueue.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.async.FreeList"]]],["^18","goog/events/events.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.debug.entryPointRegistry","~$goog.events.BrowserEvent","^2W","~$goog.events.Listenable","~$goog.events.ListenerMap"]]],["^18","goog/promise/resolver.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/events/browserfeature.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2X"]]],["^18","cljs/tools/reader/edn.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","~$cljs.tools.reader.impl.errors","~$cljs.tools.reader.reader-types","~$cljs.tools.reader.impl.utils","~$cljs.tools.reader.impl.commons","~$cljs.tools.reader","^2P","~$goog.string.StringBuffer"]]],["^18","goog/structs/priorityqueue.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.structs.Heap"]]],["^18","goog/net/xhrio.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.Timer","^2U","^2V","^3?","^2R","~$goog.json.hybrid","~$goog.log","~$goog.net.ErrorCode","~$goog.net.EventType","~$goog.net.HttpStatus","~$goog.net.XmlHttp","^2Y","^2P","~$goog.structs","~$goog.structs.Map","~$goog.uri.utils","^2X"]]],["^18","goog/promise/thenable.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/dom/nodetype.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","cljs/tools/reader/impl/inspect.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V"]]],["^18","cljs/tools/reader.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^3D","^3E","^3F","^3C","^2U","^2P","^3H"]]],["^18","taoensso/timbre.cljc"],["ed86c0ab3cf1c4771c5f9bf201405e20c3027ced","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2T","~$goog.i18n.DateTimeFormat","~$taoensso.encore","~$taoensso.timbre.appenders.core"]]],["^18","goog/net/wrapperxmlhttpfactory.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.net.XhrLike","~$goog.net.XmlHttpFactory"]]],["^18","goog/events/eventtarget.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.Disposable","^2V","~$goog.events","~$goog.events.Event","^3A","^3B","^2Y"]]],["^18","goog/date/datelike.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/disposable/disposable.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.disposable.IDisposable"]]],["^18","goog/string/typedstring.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/object/object.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/dom/asserts.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V"]]],["^18","taoensso/encore.cljc"],["8ce32d99c08a853f8a56322b5aab80e59c3bd4d6","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2T","^P","~$cljs.reader","~$cljs.tools.reader.edn","^2Y","^2U","^2P","~$goog.string.format","^3H","^3Z","~$goog.net.XhrIo","~$goog.net.XhrIoPool","~$goog.Uri.QueryData","^3N","^3M","~$taoensso.truss"]]],["^18","goog/structs/set.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^3Q","~$goog.structs.Collection","^3R"]]],"~:SHADOW-TIMESTAMP",[1630697950000,1630697950000,1630228118000],["^18","taoensso/timbre/appenders/core.cljc"],["ed86c0ab3cf1c4771c5f9bf201405e20c3027ced","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2T","^3U"]]],["^18","goog/math/long.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","^38"]]],["^18","goog/events/listener.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.events.ListenableKey"]]],["^18","goog/html/trustedresourceurl.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.html.trustedtypes","^31","^32","^33","^34"]]],["^18","goog/events/listenermap.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","~$goog.events.Listener","^2Y"]]],["^18","goog/events/eventid.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","taoensso/truss.cljs"],["02c08dae83153a50eb946c4d742f574a24bb2a76","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","~$taoensso.truss.impl"]]],["^18","goog/string/internal.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","edn_query_language/core.cljc"],["839028d06d9cc88b18b20c77c53a2bb77140d1f7","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^@"]]],["^18","goog/functions/functions.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/html/safestyle.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","~$goog.html.SafeUrl","^33","^34","^2Z"]]],["^18","goog/dom/safe.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.dom.asserts","~$goog.functions","~$goog.html.SafeHtml","~$goog.html.SafeScript","~$goog.html.SafeStyle","^4>","^30","~$goog.html.uncheckedconversions","^33","^2Z"]]],["^18","taoensso/truss/impl.cljs"],["02c08dae83153a50eb946c4d742f574a24bb2a76","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^P"]]],["^18","clojure/walk.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V"]]],["^18","goog/net/eventtype.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/structs/map.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.iter.Iterator","~$goog.iter.StopIteration"]]],["^18","goog/net/xhriopool.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^44","~$goog.structs.PriorityPool"]]],["^18","goog/date/date.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.date.DateLike","~$goog.i18n.DateTimeSymbols","^2P"]]],["^18","goog/html/safehtml.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","~$goog.dom.TagName","~$goog.dom.tags","^4B","^4C","~$goog.html.SafeStyleSheet","^4>","^30","^4;","^31","^32","^35","^2Y","^33","^34","^2Z"]]],["^18","goog/dom/tags.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2Y"]]],["^18","goog/math/size.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/structs/queue.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U"]]],["^18","goog/labs/useragent/engine.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2O","^2P"]]],["^18","cljs/reader.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2Y","^3G","^42","^3H"]]],["^18","goog/dom/dom.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","~$goog.dom.BrowserFeature","~$goog.dom.NodeType","^4J","~$goog.dom.safe","^4A","^4D","~$goog.math.Coordinate","~$goog.math.Size","^2Y","^2P","~$goog.string.Unicode","^2X"]]],["^18","goog/asserts/asserts.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.debug.Error","^4N"]]],["^18","goog/i18n/timezone.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^4H","^2Y","^2P"]]],["^18","goog/debug/logbuffer.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.debug.LogRecord"]]],["^18","goog/uri/uri.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","^2P","^3Q","^3R","^3S","~$goog.uri.utils.ComponentIndex","~$goog.uri.utils.StandardQueryParam"]]],["^18","goog/net/errorcode.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/i18n/bidi.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/disposable/idisposable.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/promise/promise.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.Thenable","^2V","^3>","~$goog.async.run","^3=","^4S","~$goog.promise.Resolver"]]],["^18","cljs/spec/alpha.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2Y","~$clojure.walk","^F","^2T"]]],["^18","goog/fs/url.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/debug/logrecord.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/base.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",[]]],["^18","goog/json/hybrid.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.json"]]],["^18","goog/structs/structs.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2Y"]]],["^18","cljs/tools/reader/impl/errors.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^3D","^2T","~$cljs.tools.reader.impl.inspect"]]],["^18","clojure/string.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^2P","^3H"]]],["^18","goog/structs/pool.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^3Y","~$goog.structs.Queue","~$goog.structs.Set"]]],["^18","goog/net/httpstatus.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/i18n/datetimeformat.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.date","^4I","~$goog.i18n.TimeZone","^2P"]]],["^18","goog/structs/heap.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2Y","~$goog.structs.Node"]]],["^18","goog/debug/entrypointregistry.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V"]]],["^18","goog/string/string.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^4O","^4D","^33","^2Z"]]],["^18","goog/reflect/reflect.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/labs/useragent/util.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2Z"]]],["^18","goog/debug/debug.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","~$goog.debug.errorcontext","^2X"]]],["^18","goog/string/stringbuffer.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/math/coordinate.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.math"]]],["^18","goog/debug/errorcontext.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","cljs/tools/reader/reader_types.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^3E","^2P","^3H"]]],["^18","goog/iter/iter.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","^4@","^57"]]],["^18","goog/async/nexttick.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^3?","~$goog.dom","^4J","^4O","^4@","^4A","^30","^35","^36","^33"]]],["^18","goog/html/uncheckedconversions.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","^4A","^4B","^4C","^4L","^4>","^30","^33","^2Z"]]],["^18","goog/debug/logger.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","~$goog.debug","~$goog.debug.LogBuffer","^4T"]]],["^18","goog/events/event.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^3Y","~$goog.events.EventId"]]],["^18","cljs/tools/reader/impl/commons.cljs"],["edd15ac0f3bbd862106bb6ba74797f0cdf57b655","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^3C","^3D","^3E"]]],["^18","goog/dom/htmlelement.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","cljs/core.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","~$goog.math.Long","~$goog.math.Integer","^2P","^2Y","^2U","^2S","^3H"]]],["^18","goog/html/safescript.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","^4;","^33","^34"]]],["^18","goog/log/log.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^59","~$goog.debug.LogManager","^4T","~$goog.debug.Logger"]]],["^18","goog/html/safestylesheet.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","^4C","^2Y","^33","^34","^2Z"]]],["^18","goog/structs/collection.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/events/browserevent.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^59","^2W","^3[","~$goog.events.EventType","^38","^2X"]]],["^18","goog/math/integer.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^38"]]],["^18","goog/structs/node.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/dom/browserfeature.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2X"]]],["^18","clojure/set.cljs"],["a0e637ee383cfd62a1f790929210efb2e372a9ce","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V"]]],["^18","goog/uri/utils.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2U","^2V","^2P"]]],["^18","goog/string/const.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","^34"]]],["^18","goog/json/json.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]],["^18","goog/events/listenable.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^5;"]]],["^18","goog/net/xmlhttpfactory.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^3W"]]],["^18","com/fulcrologic/fulcro/algorithms/denormalize.cljc"],["b14394806317d2d71b9ee21d94baa9ac23f0a7c0","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^V","^P","^R","^T"]]],["^18","goog/net/xmlhttp.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W","^2V","~$goog.net.WrapperXmlHttpFactory","^3X"]]],["^18","goog/net/xhrlike.js"],["6025affb7181cd40418600864f58eed1ea80055d","^2J",["^ ","^2K",null,"^2L",["^I",[]],"^2M",["^W"]]]]],"~:clj-info",["^ ","jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/edn.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/data.json/1.0.0/data.json-1.0.0.jar!/clojure/data/json.clj",1630617534000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/walk.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map.clj",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/io/aviso/pretty/0.1.37/pretty-0.1.37.jar!/io/aviso/columns.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/string.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/analyzer.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/util.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/externs.clj",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader/impl/errors.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/binaryage/devtools/1.0.3/devtools-1.0.3.jar!/devtools/defaults.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader/impl/inspect.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/compiler.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map/base64_vlq.clj",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/core.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/env.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/core.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/spec/gen/alpha.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/spec/alpha.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader/edn.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/com/taoensso/timbre/5.1.1/timbre-5.1.1.jar!/taoensso/timbre/appenders/core.cljc",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/js_deps.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader/default_data_readers.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/instant.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/set.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/clojure/tools/reader/reader_types.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/io/aviso/pretty/0.1.37/pretty-0.1.37.jar!/io/aviso/ansi.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/io/aviso/pretty/0.1.37/pretty-0.1.37.jar!/io/aviso/exception.clj",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/java/io.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/com/taoensso/truss/1.6.0/truss-1.6.0.jar!/taoensso/truss/impl.clj",1630697949000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/reader.clj",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojure/1.10.3/clojure-1.10.3.jar!/clojure/pprint.clj",1629997474000,"jar:file:/Users/mazeboard/.m2/repository/com/taoensso/timbre/5.1.1/timbre-5.1.1.jar!/taoensso/timbre.cljc",1630697950000,"jar:file:/Users/mazeboard/.m2/repository/com/taoensso/encore/3.10.1/encore-3.10.1.jar!/taoensso/encore.cljc",1630697949000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/tagged_literals.cljc",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/com/taoensso/truss/1.6.0/truss-1.6.0.jar!/taoensso/truss.clj",1630697949000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map/base64.clj",1630228118000,"jar:file:/Users/mazeboard/.m2/repository/org/clojure/tools.reader/1.3.4/tools.reader-1.3.4.jar!/cljs/tools/reader/reader_types.clj",1630697950000],"~:analyzer",["^ ","^3",null,"^4",["^ "],"^5",["^ ","^6","The algorithm and support functions for converting a normalized Fulcro database to a tree of denormalized props.","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",1,"^9",5,"^:",1,"^;",50],"^<",["^ ","^=","^>","^?","^@","^A","^B","^C","^D","^E","^F"],"^G",null,"^H",["^I",[]],"^J","^K","^N",null,"^O",["^ ","^P","^P","^Q","^P","^R","^R","^S","^R","^T","^T","^U","^T","^V","^V","^W","^W"],"^X",["^I",["^Y"]],"~:shadow/js-access-global",["^I",["Error"]],"^Z",null,"~:defs",["^ ","~$db->tree",["^ ","~:protocol-inline",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",209,"^9",7,"^:",209,"^;",15,"~:arglists",["^11",["~$quote",["^11",[["~$query","~$starting-entity","~$state-map"]]]]],"^6","Pull a tree of data from a fulcro normalized database as a tree corresponding to the given query.\n\n  query - EQL.\n  starting-entity - A map of data or ident at which to start.\n  state-map - The overall normalized database from which idents can be resolved.\n\n  Returns a tree of data where each resolved data node is also marked with the current\n  *denormalize-time* (dynamically bound outside of this call). Users of this function that\n  are hydrating the UI should ensure that this time is bound to Fulcro's current internal\n  basis-time using `binding`.\n\n  The `state-map` needs to be your entire Fulcro database. This database is used to resolve the joins in the EQL query\n  (which are represented as `idents`).\n\n  The starting entity can be `state-map` as well if your EQL query starts from your root. If not, it can simply be\n  the map (taken from the `state-map`) of the entity whose query you're using.\n\n  For example:\n\n  ```\n  (defsc SomeComponent [this props]\n    {:ident :thing/id\n     :query [...]})\n\n  ;; Get the sub-tree of data for thing 1:\n  (db->tree\n    (comp/get-query SomeComponent)\n    (get-in state-map [:thing/id 1])\n    state-map)\n  ```\n  "],"^J","^28","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",15,"~:method-params",["^11",[["^6E","^6F","^6G"]]],"~:protocol-impl",null,"~:arglists-meta",["^11",[null,null]],"^9",1,"~:variadic?",false,"^8",209,"~:ret-tag",["^I",["~$clj","~$cljs.core/MetaFn","~$clj-nil"]],"^:",209,"~:max-fixed-arity",3,"~:fn-var",true,"^6C",["^11",["^6D",["^11",[["^6E","^6F","^6G"]]]]],"^6","Pull a tree of data from a fulcro normalized database as a tree corresponding to the given query.\n\n  query - EQL.\n  starting-entity - A map of data or ident at which to start.\n  state-map - The overall normalized database from which idents can be resolved.\n\n  Returns a tree of data where each resolved data node is also marked with the current\n  *denormalize-time* (dynamically bound outside of this call). Users of this function that\n  are hydrating the UI should ensure that this time is bound to Fulcro's current internal\n  basis-time using `binding`.\n\n  The `state-map` needs to be your entire Fulcro database. This database is used to resolve the joins in the EQL query\n  (which are represented as `idents`).\n\n  The starting entity can be `state-map` as well if your EQL query starts from your root. If not, it can simply be\n  the map (taken from the `state-map`) of the entity whose query you're using.\n\n  For example:\n\n  ```\n  (defsc SomeComponent [this props]\n    {:ident :thing/id\n     :query [...]})\n\n  ;; Get the sub-tree of data for thing 1:\n  (db->tree\n    (comp/get-query SomeComponent)\n    (get-in state-map [:thing/id 1])\n    state-map)\n  ```\n  "],"~$add-join!",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",82,"^9",8,"^:",82,"^;",17,"~:private",true,"^6C",["^11",["^6D",["^11",[["~$n",["^ ","~:keys",["^6E","~$key"],"^13","~$join-node"],"~$entity","^6G","~$parent-node","~$idents-seen"]]]]]],"^6S",true,"^J","^1T","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",17,"^6H",["^11",[["~$n","~$p__55004","^6W","^6G","^6X","^6Y"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",82,"^6L",["^I",[null,"^6M"]],"^:",82,"^6P",6,"^6Q",true,"^6C",["^11",["^6D",["^11",[["~$n",["^ ","^6T",["^6E","^6U"],"^13","^6V"],"^6W","^6G","^6X","^6Y"]]]]]],"~$link-ref?",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",11,"^9",7,"^:",11,"^;",16,"^6C",["^11",["^6D",["^11",[["~$v"]]]]],"^6","Is the given `v` a link ref query (e.g. `[:table '_]) element."],"^J","^2<","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",16,"^6H",["^11",[["~$v"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",11,"^6L","~$boolean","^:",11,"^6P",1,"^6Q",true,"^6C",["^11",["^6D",["^11",[["~$v"]]]]],"^6","Is the given `v` a link ref query (e.g. `[:table '_]) element."],"~$*denormalize-time*",["^ ","^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",8,"^9",16,"^:",8,"^;",34,"~:dynamic",true],"^J","^2@","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",34,"^9",1,"^72",true,"^8",8,"^:",8,"~:tag","~$number"],"~$add-joins!",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",176,"^9",8,"^:",176,"^;",18,"^6S",true,"^6C",["^11",["^6D",["^11",[["~$transient-node","^6W","^6G","^6X","~$ast-join-nodes","^6Y"]]]]]],"^6S",true,"^J","^2?","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",18,"^6H",["^11",[["^76","^6W","^6G","^6X","^77","^6Y"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",176,"^6L",["^I",[null,"~$any"]],"^:",176,"^6P",6,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^76","^6W","^6G","^6X","^77","^6Y"]]]]]],"~$possibly-stale?",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",264,"^9",7,"^:",264,"^;",22,"^6C",["^11",["^6D",["^11",[["~$current-state-map","~$prior-props"]]]]],"^6","Returns true if the given `prior-props` are likely to be stale with respect to the `current-state-map`. This function\n   returns true unless the `prior-props` were generated with `traced-db->tree` and have not since lost their metadata.\n\n   When called with properly-annotated props this function can do a very fast and accurate check to indicate if the props\n   seem out of date. Runs N `identical?` checks (which are reference compares) where N is the number of root keys and idents\n   that were traversed to originally build prior-props.\n\n   This is not proof that the props have changed, but the false indicators will all be `true`, meaning it is a safe (and\n   faster) replacement for the comparisons that `shouldComponentUpdate` usually use.\n   "],"^J","^2E","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",22,"^6H",["^11",[["^7:","^7;"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",264,"^6L",["^I",[null,"^70","^78"]],"^:",264,"^6P",2,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^7:","^7;"]]]]],"^6","Returns true if the given `prior-props` are likely to be stale with respect to the `current-state-map`. This function\n   returns true unless the `prior-props` were generated with `traced-db->tree` and have not since lost their metadata.\n\n   When called with properly-annotated props this function can do a very fast and accurate check to indicate if the props\n   seem out of date. Runs N `identical?` checks (which are reference compares) where N is the number of root keys and idents\n   that were traversed to originally build prior-props.\n\n   This is not proof that the props have changed, but the false indicators will all be `true`, meaning it is a safe (and\n   faster) replacement for the comparisons that `shouldComponentUpdate` usually use.\n   "],"~$traced-db->tree",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",251,"^9",7,"^:",251,"^;",22,"^6C",["^11",["^6D",["^11",[["^6G","~$root-key-or-ident","^6E"]]]]],"^6","Similar to `db->tree`; however, the returned props will have annotated metadata the indicates what root keys and\n   idents were visited during the conversion to a tree, along with the source state map that was used. Such props can\n   be used with `possibly-stale?` to do very fast checks to see if an update is needed when `state-map` changes."],"^J","^2A","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",22,"^6H",["^11",[["^6G","^7=","^6E"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",251,"^:",251,"^6P",3,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^6G","^7=","^6E"]]]]],"^6","Similar to `db->tree`; however, the returned props will have annotated metadata the indicates what root keys and\n   idents were visited during the conversion to a tree, along with the source state map that was used. Such props can\n   be used with `possibly-stale?` to do very fast checks to see if an update is needed when `state-map` changes."],"~$*root-keys-and-idents*",["^ ","^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",9,"^9",16,"^:",9,"^;",38,"^72",true],"^J","^2=","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",38,"^9",1,"^72",true,"^8",9,"^:",9,"^73","^6O"],"~$denormalization-time",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",246,"^9",7,"^:",246,"^;",27,"^6C",["^11",["^6D",["^11",[["~$props"]]]]],"^6","Gets the time at which the given props were processed by `db->tree`, if known."],"^J","^2B","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",27,"^6H",["^11",[["^7@"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",246,"^6L",["^I",["^78","^6O"]],"^:",246,"^6P",1,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^7@"]]]]],"^6","Gets the time at which the given props were processed by `db->tree`, if known."],"~$with-time",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",49,"^9",7,"^:",49,"^;",16,"^6C",["^11",["^6D",["^11",[["^7@","~$t"]]]]],"^6","Associates time metadata with the given props. This time can be used by rendering optimizations to decide when\n  stale props are passed to it from a parent in cases where props tunnelling was used for localized refresh."],"^J","^1E","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",16,"^6H",["^11",[["^7@","~$t"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",49,"^6L",["^I",["^6M","^6N","^6O"]],"^:",49,"^6P",2,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^7@","~$t"]]]]],"^6","Associates time metadata with the given props. This time can be used by rendering optimizations to decide when\n  stale props are passed to it from a parent in cases where props tunnelling was used for localized refresh."],"~$lookup-ref?",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",20,"^9",7,"^:",20,"^;",18,"^6C",["^11",["^6D",["^11",[["~$v"]]]]],"^6","Is the given `v` a lookup ref query (i.e. ident)?"],"^J","^1M","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",18,"^6H",["^11",[["~$v"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",20,"^6L","^70","^:",20,"^6P",1,"^6Q",true,"^6C",["^11",["^6D",["^11",[["~$v"]]]]],"^6","Is the given `v` a lookup ref query (i.e. ident)?"],"~$denormalize",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",186,"^9",7,"^:",186,"^;",18,"^6C",["^11",["^6D",["^11",[[["^ ","^6T",["~$type","~$children"],"^13","~$top-node"],"~$current-entity","^6G","^6Y"]]]]],"^6","Internal implementation of `db->tree`.  You should normally use `db->tree` instead of this function.\n\n  - `top-node`: an AST for the query.\n  - `current-entity`: The entity to start denormalization from.\n  - `state-map`: a normalized database.\n  - `idents-seen`: a map of the idents seen so far (for recursion loop tracking)."],"^J","^1Q","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",18,"^6H",["^11",[["~$p__55044","^7G","^6G","^6Y"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",186,"^6L",["^I",["^6M","^6N","^6O"]],"^:",186,"^6P",4,"^6Q",true,"^6C",["^11",["^6D",["^11",[[["^ ","^6T",["^7D","^7E"],"^13","^7F"],"^7G","^6G","^6Y"]]]]],"^6","Internal implementation of `db->tree`.  You should normally use `db->tree` instead of this function.\n\n  - `top-node`: an AST for the query.\n  - `current-entity`: The entity to start denormalization from.\n  - `state-map`: a normalized database.\n  - `idents-seen`: a map of the idents seen so far (for recursion loop tracking)."],"~$add-union!",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",144,"^9",8,"^:",144,"^;",18,"^6S",true,"^6C",["^11",["^6D",["^11",[["~$n",["^ ","^6T",["^6U"],"^13","^6V"],"^6W","^6G","^6Y"]]]]]],"^6S",true,"^J","^23","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",18,"^6H",["^11",[["~$n","~$p__55023","^6W","^6G","^6Y"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",144,"^6L",["^I",[null,"^6M"]],"^:",144,"^6P",5,"^6Q",true,"^6C",["^11",["^6D",["^11",[["~$n",["^ ","^6T",["^6U"],"^13","^6V"],"^6W","^6G","^6Y"]]]]]],"~$ref-key",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",39,"^9",7,"^:",39,"^;",14,"^6C",["^11",["^6D",["^11",[[["~$table","~$id","^13","~$ref"]]]]]],"^6","Returns the key to use in results for the given ref (ident of lookup ref). For link refs this is just\n  the first element, and for idents it is the ident."],"^J","^20","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",14,"^6H",["^11",[["~$p__54971"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",39,"^6L",["^I",[null,"^78","^6O"]],"^:",39,"^6P",1,"^6Q",true,"^6C",["^11",["^6D",["^11",[[["^7L","^7M","^13","^7N"]]]]]],"^6","Returns the key to use in results for the given ref (ident of lookup ref). For link refs this is just\n  the first element, and for idents it is the ident."],"~$add-props!",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",55,"^9",8,"^:",55,"^;",18,"^6S",true,"^6C",["^11",["^6D",["^11",[["^76","^6W","~$ast-prop-children","^6G"]]]]],"^6","Walk the given AST children (which MUST be prop nodes), and add their values from `current-entity`\n  (if found)."],"^6S",true,"^J","^1[","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",18,"^6H",["^11",[["^76","^6W","^7Q","^6G"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",55,"^6L",["^I",[null,"^78"]],"^:",55,"^6P",4,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^76","^6W","^7Q","^6G"]]]]],"^6","Walk the given AST children (which MUST be prop nodes), and add their values from `current-entity`\n  (if found)."],"~$reduce-depth",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",71,"^9",8,"^:",71,"^;",20,"^6S",true,"^6C",["^11",["^6D",["^11",[["^6X","^6V"]]]]],"^6","Reduce the query depth on `join-node` that appears within the children of `parent-node`."],"^6S",true,"^J","^1P","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",20,"^6H",["^11",[["^6X","^6V"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",71,"^6L",["^I",["^6M","^78"]],"^:",71,"^6P",2,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^6X","^6V"]]]]],"^6","Reduce the query depth on `join-node` that appears within the children of `parent-node`."],"~$follow-ref",["^ ","^6B",null,"^5",["^ ","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^8",25,"^9",7,"^:",25,"^;",17,"^6C",["^11",["^6D",["^11",[["^6G",["^7L","^7M","^13","^7N"]]]]]],"^6","Returns the value defined by the `ref` from `state-map`.  Works for link refs and\n  lookup refs."],"^J","^1F","^7","com/fulcrologic/fulcro/algorithms/denormalize.cljc","^;",17,"^6H",["^11",[["^6G","~$p__54957"]]],"^6I",null,"^6J",["^11",[null,null]],"^9",1,"^6K",false,"^8",25,"^6L",["^I",[null,"^78","^6O"]],"^:",25,"^6P",2,"^6Q",true,"^6C",["^11",["^6D",["^11",[["^6G",["^7L","^7M","^13","^7N"]]]]]],"^6","Returns the value defined by the `ref` from `state-map`.  Works for link refs and\n  lookup refs."]],"^[",["^ ","^V","^V","^T","^T","^U","^T"],"~:cljs.analyzer/constants",["^ ","^X",["^I",["~:children","~:union-key","~:key","~:else","~:warn","~$*","~:type","~$_","~:otherwise","~:prop","~:com.fulcrologic.fulcro.algorithms.denormalize/time","~:com.fulcrologic.fulcro.algorithms.denormalize/source-state-map","~:query","~$...","~:com.fulcrologic.fulcro.algorithms.denormalize/visited","~:auto","~:p","~:join"]],"~:order",["~$_","^82","^7X","^7V","^84","^85","^7Y","^7Z","~:p","^87","^80","^7W","^7[","^81","~$*","^88","^86","^83"]],"^14",["^ ","^Y",["^I",[]]],"^15",["^ "],"^16",["^W","^V","^P","^R","^T"]],"^M","^K","~:ns-specs",["^ "],"~:ns-spec-vars",["^I",[]],"~:compiler-options",["^2I",[["^8<","~:static-fns"],true,["^8<","~:shadow-tweaks"],null,["^8<","~:source-map-inline"],null,["^8<","~:elide-asserts"],false,["^8<","~:optimize-constants"],null,["^8<","^1;"],null,["^8<","~:external-config"],null,["^8<","~:tooling-config"],null,["^8<","~:emit-constants"],null,["^8<","~:load-tests"],null,["^8<","~:form-size-threshold"],null,["^8<","~:data-readers"],null,["^8<","~:infer-externs"],"^87",["^8<","^1="],null,["~:js-options","~:js-provider"],"~:shadow",["~:mode"],"~:dev",["^8<","~:fn-invoke-direct"],null,["^8<","~:source-map"],"/dev/null"]]]